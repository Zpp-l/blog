#树组件 #深克隆

## iView 树组件

[[前置知识#递归组件]]

- 节点可以无限延伸（递归）；
  - `children`
- 可以展开 / 收起子节点；
  - `expand` 属性
- 节点可以选中，选中父节点，它的所有子节点也全部被选中，同样，反选父节点，其所有子节点也取消选择；
  - 消息订阅？
- 同一级所有子节点选中时，它的父级也自动选中，一直递归判断到根节点。

### 节点配置(props)

- title
- expand
- checked
- children
- showCheckbox
- @event: on-toggle-expand / on-check-change

## 选中与取消选中

- 点击父组件，全选所有子组件
  - 遍历子组件的集合，设置为checked状态

  ```js
  handleCheck(checked){
  	this.updateTreeDown(this.data,checked) // 当前组件
  	if(this.tree){
  		this.tree.emitEvent('on-check-change',this.data) // 反馈给tree组件，给使用者的相应，用以处理新的业务逻辑
  	}
  }
  updateTreeDown(data,checked){
  	this.$set(data,'checked',checked)
  	if(data.children && data.children.length){
  		data.forEach(item=>{
  			this.updateTreeDown(item,checked)
  		})
  	}
  }
  ```

  - 因为是递归组件，当调用updateTreeDown方法，下面所有子组件都会调用到这个方法。
- 点击所有子组件后，父组件选中
  - 向上递归是复杂且需要key的，不妨使用监听watch，因为递归组件的原因，监听到子组件的变化，本身就会发生变化，而且本身作为子组件，父组件自然也会发生改变.

  ```js
  watch:{
  	'data.children':{
  		deep:true,
  		handler(data){
  			const 
  		}
  	}
  }
  ```

## 异步加载树

**期望**：点击节点，自动获取数据，如果是叶子节点，没有expand属性
ant-design-vue
